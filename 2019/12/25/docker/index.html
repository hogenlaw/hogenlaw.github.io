<html>
  <head><meta name="generator" content="Hexo 3.8.0">
    <title>docker - hogen</title>
    <link href="/images/fav.png" rel="shortcut icon">
<link href="undefined" rel="alternate" type="application/rss+xml">
<link rel="stylesheet" href="/css/style.css">
<link rel="stylesheet" href="/css/highlight.css">
<link rel="stylesheet" href="/css/responsive.css">
<script src="/js/jquery.js"></script>
<script src="/js/basics.js"></script>
<meta content="width=device-width, initial-scale=1.0, user-scalable=no" name="viewport">
<meta content="text/html; charset=utf-8" http-equiv="content-type">


  </head>
  <body>
    <header>
  <a id="go-back-home" href="/"><img src="/images/scribble.png" alt="Home" width="53" height="59"></a>
  <p>hogen</p>
  <p>Follow Excellence. Success will chase you.</p>
</header>

    <div id="container">
      <div class="block">
  
    <a class="main" href="/">Home</a>
  
    <a class="main" href="/about">About</a>
  
    <a class="main" href="https://github.com/hogenlaw">Github</a>
  
    <a class="main" href="mailto:lhg9300@foxmail.com">Email</a>
  
</div>

      <section class="paging">
  
    <div class="left">
      <a href="/2019/12/31/2019-summary/">
        ‹
      </a>
    </div>
  
  
    <div class="right">
      <a href="/2019/12/24/linux-command/">
        ›
      </a>
    </div>
  
</section>

      <div class="content">
        <section class="post">
          <h1>
            <!-- <div class='date'>2019-12-25</div> --><!--正文的日期-->
            docker
          </h1>
          <h3 id="docker的安装"><a href="#docker的安装" class="headerlink" title="docker的安装"></a>docker的安装</h3><p>Docker 需要两个重要的安装要求：</p>
<ul>
<li>它仅适用于 64 位 Linux 安装</li>
<li>它需要 Linux 内核版本 3.10 或更高版本。</li>
</ul>
<p>要查看当前的内核版本，请打开终端并键入<code>uname -r</code>命令以查看内核版本：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost local]# uname -r</span><br><span class="line">3.10.0-1062.4.3.el7.x86_64</span><br></pre></td></tr></table></figure>
<p>查看操作系统是32位还是64位：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost local]# uname --m</span><br><span class="line">x86_64</span><br></pre></td></tr></table></figure>
<h4 id="CentOS安装Docker"><a href="#CentOS安装Docker" class="headerlink" title="CentOS安装Docker"></a>CentOS安装Docker</h4><p>更新yum到最新</p>
<p><code>sudo yum update</code></p>
<p>安装需要的软件包</p>
<p><code>sudo yum install -y yum-utils device-mapper-persistent-data lvm2</code></p>
<p>设置yum源为阿里云</p>
<p><code>sudo yum-config-manager --add-repo http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo</code></p>
<p>安装docker(-ce和-ee两个版本，-ee是要收费的..)</p>
<p><code>sudo yum install docker-ce</code></p>
<p>查看版本</p>
<p><code>docker-v</code></p>
<h4 id="Ubuntu安装Docker"><a href="#Ubuntu安装Docker" class="headerlink" title="Ubuntu安装Docker"></a>Ubuntu安装Docker</h4><p>安装必要的一些系统工具</p>
<p><code>sudo apt-get update</code><br><code>sudo apt-get -y install apt-transport-https ca-certificates curl software-properties-common</code></p>
<p>安装 GPG 证书</p>
<p><code>curl -fsSL http://mirrors.aliyun.com/docker-ce/linux/ubuntu/gpg | sudo apt-key add -</code></p>
<p>写入软件源信息</p>
<p><code>sudo add-apt-repository &quot;deb [arch=amd64] http://mirrors.aliyun.com/docker-ce/linux/ubuntu $(lsb_release -cs) stable&quot;</code></p>
<p>更新并安装 Docker CE</p>
<p><code>sudo apt-get -y update &amp;&amp; sudo apt-get -y install docker-ce</code></p>
<h3 id="docker-常用命令"><a href="#docker-常用命令" class="headerlink" title="docker 常用命令"></a>docker 常用命令</h3><p>docker镜像是唯一的，但是基于镜像创建的容器名字可以有很多，比如tomcat、mysql…利用这些镜像可以创建好多实例(类似于类于对象)</p>
<p>查看 docker 磁盘使用情况</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker system df</span><br></pre></td></tr></table></figure>
<p>拉取镜像，<a href="https://hub.docker.com/" target="_blank" rel="noopener">网址</a></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker pull tomcat/mysql/nginx</span><br></pre></td></tr></table></figure>
<p>查看所有镜像</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker images</span><br></pre></td></tr></table></figure>
<p>删除某一镜像</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker rmi nginx</span><br></pre></td></tr></table></figure>
<p>启动/停止docker服务</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl start/stop docker</span><br></pre></td></tr></table></figure>
<p>mysql 启动，MYSQL_ROOT_PASSWORD表示给根用户(root)设置密码</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -p 3306:3306 --name mysql -e MYSQL_ROOT_PASSWORD=root -d mysql:5.7</span><br></pre></td></tr></table></figure>
<p>-d 后台运行，宿主机端口:容器端口</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -p 8080:8080 -d tomcat</span><br></pre></td></tr></table></figure>
<p>查看容器(正在运行的容器)</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker ps</span><br></pre></td></tr></table></figure>
<p>查看容器(正在运行的和没运行的)</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker ps -a</span><br></pre></td></tr></table></figure>
<p>查询最后一次创建的容器</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker ps -l</span><br></pre></td></tr></table></figure>
<p>停止/启动容器</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker stop/start 容器ID</span><br></pre></td></tr></table></figure>
<p>删除容器</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker rm 容器ID</span><br></pre></td></tr></table></figure>
<blockquote>
<p>删除容器时，容器必须是停止状态，否则会报错</p>
</blockquote>
<p>强制删除容器</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker rm -f 容器ID</span><br></pre></td></tr></table></figure>
<p>守护态启动并命名为tomcat ，不加name会给个随机名</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -p 8080:8080 --name tomcat -d tomcat</span><br></pre></td></tr></table></figure>
<p>参数说明：</p>
<ul>
<li><code>-d</code>：让容器在后台运行</li>
<li><code>-P</code>：将容器内部使用的网络端口映射到我们使用的主机上</li>
</ul>
<p>清理所有处于终止状态的容器</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker container ls -a 命令可以查看所有已经创建的包括终止状态的容器</span><br></pre></td></tr></table></figure>
<p>停止</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker container stop 容器ID</span><br></pre></td></tr></table></figure>
<p>重启</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker container restart 容器ID</span><br></pre></td></tr></table></figure>
<p>如果数量太多要一个个删除可能会很麻烦，用下面的命令可以清理掉所有处于终止状态的容器。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker container prune</span><br></pre></td></tr></table></figure>
<p>删除虚玄镜像</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost mytomcat]# docker images</span><br><span class="line">REPOSITORY          TAG                 IMAGE ID            CREATED             SIZE</span><br><span class="line">mytomcat            latest              526d8e59aecf        7 minutes ago       507MB</span><br><span class="line">&lt;none&gt;              &lt;none&gt;              31aadb129895        About an hour ago   507MB</span><br><span class="line">tomcat              latest              6fa48e047721        2 weeks ago         507MB</span><br><span class="line">[root@localhost mytomcat]# docker image prune</span><br><span class="line">WARNING! This will remove all dangling images.</span><br><span class="line">Are you sure you want to continue? [y/N] y</span><br><span class="line">Deleted Images:</span><br><span class="line">deleted: sha256:31aadb129895bbab6d8c59e1a7d54d4bc579d9eee39e00dd0b54e82843916514</span><br><span class="line">deleted: sha256:39644b3b75b0f9d5e944a62938c0d8cbdf564477f0260e94e811ee748cd5cd4f</span><br><span class="line">Total reclaimed space: 27B</span><br><span class="line">[root@localhost mytomcat]# docker images</span><br><span class="line">REPOSITORY          TAG                 IMAGE ID            CREATED             SIZE</span><br><span class="line">mytomcat            latest              526d8e59aecf        7 minutes ago       507MB</span><br><span class="line">tomcat              latest              6fa48e047721        2 weeks ago         507MB</span><br></pre></td></tr></table></figure>
<h3 id="交互的方式启动容器"><a href="#交互的方式启动容器" class="headerlink" title="交互的方式启动容器"></a>交互的方式启动容器</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -it [镜像名] /bin/bash</span><br></pre></td></tr></table></figure>
<p>交互完了就删除</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -it --rm tomcat /bin/bash</span><br></pre></td></tr></table></figure>
<h3 id="交互的方式进入容器"><a href="#交互的方式进入容器" class="headerlink" title="交互的方式进入容器"></a>交互的方式进入容器</h3><p>我们通过 docker 的两个参数 <code>-i</code> <code>-t</code>，让 docker 运行的容器实现”对话”的能力</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker exec -it 容器ID /bin/bash</span><br></pre></td></tr></table></figure>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost /]# docker exec -it 204b0f04f689 /bin/bash</span><br><span class="line">root@204b0f04f689:/usr/local/tomcat# pwd</span><br><span class="line">/usr/local/tomcat</span><br></pre></td></tr></table></figure>
<p>参数解释：</p>
<ul>
<li><code>-t</code>：在新容器内指定一个伪终端或终端</li>
<li><code>-i</code>：允许你对容器内的标准输入进行交互</li>
</ul>
<p>此时我们已进入一个204b0f04f689 系统的容器，在容器中运行命令 <code>cat /proc/version</code> 和<code>ls</code> 分别查看当前系统的版本信息和当前目录下的文件列表</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">root@204b0f04f689:/usr/local/tomcat# cat /proc/version</span><br><span class="line">Linux version 3.10.0-1062.4.3.el7.x86_64 (mockbuild@kbuilder.bsys.centos.org) (gcc version 4.8.5 20150623 (Red Hat 4.8.5-39) (GCC) ) #1 SMP Wed Nov 13 23:58:53 UTC 2019</span><br><span class="line">root@204b0f04f689:/usr/local/tomcat# ls</span><br><span class="line">BUILDING.txt	 LICENSE  README.md	 RUNNING.txt  conf     lib   native-jni-lib  webapps</span><br><span class="line">CONTRIBUTING.md  NOTICE   RELEASE-NOTES  bin	      include  logs  temp	     work</span><br></pre></td></tr></table></figure>
<p>退出容器：</p>
<ul>
<li>运行 exit</li>
<li>使用 CTRL + D</li>
</ul>
<h3 id="查看-web-应用日志"><a href="#查看-web-应用日志" class="headerlink" title="查看 web 应用日志"></a>查看 web 应用日志</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost /]# docker ps</span><br><span class="line">CONTAINER ID        IMAGE               COMMAND                  CREATED             STATUS              PORTS                               NAMES</span><br><span class="line">204b0f04f689        tomcat              "catalina.sh run"        20 minutes ago      Up 17 minutes       0.0.0.0:8080-&gt;8080/tcp              tomcat</span><br><span class="line">2523581ab95a        mysql:5.7           "docker-entrypoint.s…"   5 days ago          Up 5 days           0.0.0.0:3306-&gt;3306/tcp, 33060/tcp   mysql</span><br><span class="line">[root@localhost /]# docker logs -f 204b0f04f689/tomcat</span><br></pre></td></tr></table></figure>
<p>参数说明：</p>
<ul>
<li><code>-f</code>：让 dokcer logs 像使用 tail -f 一样来输出容器内部的标准输出</li>
</ul>
<h3 id="查看-WEB-应用容器的进程"><a href="#查看-WEB-应用容器的进程" class="headerlink" title="查看 WEB 应用容器的进程"></a>查看 WEB 应用容器的进程</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost /]# docker top mysql</span><br><span class="line">UID                 PID                 PPID                C                   STIME               TTY                 TIME                CMD</span><br><span class="line">polkitd             2282                2266                0                   Dec25               ?                   00:04:21            mysqld</span><br></pre></td></tr></table></figure>
<h3 id="检查-WEB-应用程序"><a href="#检查-WEB-应用程序" class="headerlink" title="检查 WEB 应用程序"></a>检查 WEB 应用程序</h3><p>使用 <code>docker inspect</code> 来查看Docker的底层信息。它会返回一个 JSON 文件记录着 Docker 容器的配置和状态信息：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost /]# docker inspect mysql</span><br></pre></td></tr></table></figure>
<h3 id="docker-镜像管理"><a href="#docker-镜像管理" class="headerlink" title="docker 镜像管理"></a>docker 镜像管理</h3><h4 id="镜像列表"><a href="#镜像列表" class="headerlink" title="镜像列表"></a>镜像列表</h4><p>当运行容器时，使用的镜像如果在本地中不存在，docker 就会自动从 docker 镜像仓库中下载，默认是从 <a href="https://hub.docker.com/" target="_blank" rel="noopener">Docker Hub</a> 公共镜像源下载。</p>
<p>可以使用 <code>docker images</code> 来列出本地主机上的镜像：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost /]# docker images</span><br><span class="line">REPOSITORY          TAG                 IMAGE ID            CREATED             SIZE</span><br><span class="line">tomcat              latest              6fa48e047721        2 weeks ago         507MB</span><br><span class="line">mysql               5.7                 1e4405fe1ea9        5 weeks ago         437MB</span><br></pre></td></tr></table></figure>
<p>参数说明：</p>
<ul>
<li>REPOSITORY：表示镜像的仓库源</li>
<li>TAG：镜像的标签</li>
<li>IMAGE ID：镜像ID</li>
<li>CREATED：镜像创建时间</li>
<li>SIZE：镜像大小</li>
</ul>
<blockquote>
<p>同一仓库源可以有多个 TAG，代表这个仓库源的不同个版本，不同的版本，我们使用 <code>REPOSITORY:TAG</code> 来定义不同的镜像。如果不指定一个镜像的版本标签，例如你只使用 tomcat，docker 将默认使用 tomcat:latest 镜像。</p>
</blockquote>
<h4 id="获取镜像"><a href="#获取镜像" class="headerlink" title="获取镜像"></a>获取镜像</h4><p>当我们在本地主机上使用一个不存在的镜像时 Docker 就会自动下载这个镜像。如果我们想预先下载这个镜像，我们可以使用 <code>docker pull</code> 命令来下载它。下面获取 tomcat时指定了 TAG</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost /]# docker pull tomcat:jdk8</span><br><span class="line">jdk8: Pulling from library/tomcat</span><br><span class="line">146bd6a88618: Pull complete </span><br><span class="line">9935d0c62ace: Pull complete </span><br><span class="line">db0efb86e806: Pull complete </span><br><span class="line">e705a4c4fd31: Pull complete </span><br><span class="line">3d3bf7f7e874: Pull complete </span><br><span class="line">49371c5b9ff6: Pull complete </span><br><span class="line">e7873a7ca0fd: Pull complete </span><br><span class="line">925a95344b57: Pull complete </span><br><span class="line">9114285af3b8: Pull complete </span><br><span class="line">82ad83395ce2: Pull complete </span><br><span class="line">Digest: sha256:afa5c0b06a8625c7f70a4ba9e242bdc52fd3c98d424438319c81ae882a946d11</span><br><span class="line">Status: Downloaded newer image for tomcat:jdk8</span><br><span class="line">docker.io/library/tomcat:jdk8</span><br><span class="line">[root@localhost /]# docker images</span><br><span class="line">REPOSITORY          TAG                 IMAGE ID            CREATED             SIZE</span><br><span class="line">tomcat              jdk8                94e31e5297d1        47 hours ago        507MB</span><br><span class="line">tomcat              latest              6fa48e047721        2 weeks ago         507MB</span><br><span class="line">mysql               5.7                 1e4405fe1ea9        5 weeks ago         437MB</span><br></pre></td></tr></table></figure>
<h4 id="查找镜像"><a href="#查找镜像" class="headerlink" title="查找镜像"></a>查找镜像</h4><p>我们可以从 Docker Hub 网站来搜索镜像，Docker Hub 网址为： <a href="https://hub.docker.com/" target="_blank" rel="noopener">https://hub.docker.com/</a></p>
<p>我们也可以使用 <code>docker search</code> 命令来搜索镜像。比如我们需要一个 <code>httpd</code> 的镜像来作为我们的 <code>web</code> 服务。我们可以通过 <code>docker search</code> 命令搜索 <code>httpd</code> 来寻找适合我们的镜像。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost /]# docker search nginx</span><br><span class="line">NAME                              DESCRIPTION                                     STARS               OFFICIAL            AUTOMATED</span><br><span class="line">nginx                             Official build of Nginx.                        12403               [OK]                </span><br><span class="line">jwilder/nginx-proxy               Automated Nginx reverse proxy for docker con…   1708                                    [OK]</span><br><span class="line">richarvey/nginx-php-fpm           Container running Nginx + PHP-FPM capable of…   749                                     [OK]</span><br><span class="line">linuxserver/nginx                 An Nginx container, brought to you by LinuxS…   84                                      </span><br><span class="line">bitnami/nginx                     Bitnami nginx Docker Image                      74                                      [OK]</span><br><span class="line">tiangolo/nginx-rtmp               Docker image with Nginx using the nginx-rtmp…   60                                      [OK]</span><br><span class="line">nginxdemos/hello                  NGINX webserver that serves a simple page co…   35                                      [OK]</span><br><span class="line">.......</span><br></pre></td></tr></table></figure>
<p>说明：</p>
<ul>
<li>NAME：镜像仓库源的名称</li>
<li>DESCRIPTION：镜像的描述</li>
<li>OFFICIAL：是否docker官方发布</li>
</ul>
<h4 id="创建镜像"><a href="#创建镜像" class="headerlink" title="创建镜像"></a>创建镜像</h4><p>当我们从 docker 镜像仓库中下载的镜像不能满足我们的需求时，我们可以通过以下两种方式对镜像进行更改：</p>
<ul>
<li>从已经创建的容器中更新镜像，并且提交这个镜像</li>
<li>使用 Dockerfile 指令来创建一个新的镜像</li>
</ul>
<h4 id="更新镜像"><a href="#更新镜像" class="headerlink" title="更新镜像"></a>更新镜像</h4><p>更新镜像之前，我们需要使用镜像来创建一个容器：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# docker ps</span><br><span class="line">CONTAINER ID        IMAGE               COMMAND                  CREATED             STATUS              PORTS                               NAMES</span><br><span class="line">01bc1dd29828        tomcat              "/bin/bash"              4 minutes ago       Up 4 minutes        8080/tcp                            wizardly_ishizaka</span><br><span class="line">204b0f04f689        tomcat              "catalina.sh run"        46 minutes ago      Up 43 minutes       0.0.0.0:8080-&gt;8080/tcp              tomcat</span><br><span class="line">2523581ab95a        mysql:5.7           "docker-entrypoint.s…"   5 days ago          Up 5 days           0.0.0.0:3306-&gt;3306/tcp, 33060/tcp   mysql</span><br><span class="line">[root@localhost ~]# docker exec -it 01bc1dd29828 /bin/bash</span><br><span class="line">root@01bc1dd29828:/usr/local/tomcat# apt-get update</span><br><span class="line">Ign:1 http://deb.debian.org/debian stretch InRelease</span><br><span class="line">Hit:2 http://security.debian.org/debian-security stretch/updates InRelease</span><br><span class="line">Hit:3 http://deb.debian.org/debian stretch-updates InRelease</span><br><span class="line">Hit:4 http://deb.debian.org/debian stretch Release </span><br><span class="line">Reading package lists... Done</span><br></pre></td></tr></table></figure>
<p>在完成操作之后，输入 <code>exit</code> 命令来退出这个容器。</p>
<p>此时ID为 <code>01bc1dd29828</code> 的容器，是按我们的需求更改的容器。我们可以通过命令 <code>docker commit</code> 来提交容器副本。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# docker commit -m="has update" -a="hogen" 01bc1dd29828 hogen/tomcat:v2</span><br><span class="line">sha256:2586747a18c26756ff9b0e6e20cdffb154cb3d841c34fd5bb8133c06e2070771</span><br></pre></td></tr></table></figure>
<p>参数说明：</p>
<ul>
<li>-m：提交的描述信息</li>
<li>-a：指定镜像作者</li>
<li>01bc1dd29828：容器ID</li>
<li>hogen/tomcat:v2：指定要创建的目标镜像名，TAG名</li>
</ul>
<p>我们可以使用 <code>docker images</code> 命令来查看我们的新镜像 hogen/tomcat:v2：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# docker images</span><br><span class="line">REPOSITORY          TAG                 IMAGE ID            CREATED             SIZE</span><br><span class="line">hogen/tomcat        v2                  2586747a18c2        8 seconds ago       523MB</span><br><span class="line">tomcat              jdk8                94e31e5297d1        2 days ago          507MB</span><br><span class="line">tomcat              latest              6fa48e047721        2 weeks ago         507MB</span><br></pre></td></tr></table></figure>
<p>使用我们的新镜像 hogen/tomcat 来启动一个容器：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# docker run -it hogen/tomcat:v2 /bin/bash</span><br><span class="line">root@0904f7582b5e:/usr/local/tomcat#</span><br></pre></td></tr></table></figure>
<p><code>docker run -it [镜像名] /bin/bash</code>： 启动容器的时候立即进入交互</p>
<h3 id="Dockerfile"><a href="#Dockerfile" class="headerlink" title="Dockerfile"></a>Dockerfile</h3><p>在之前的例子中，我们所使用的都是来自于 Docker Hub 的镜像。直接使用这些镜像是可以满足一定的需求，而当这些镜像无法直接满足需求时，我们就需要定制这些镜像。</p>
<p>一次构建到处运行：通俗的讲就是把我们的应用程序以及需要的一些操作打包成镜像，这时候就能做到一次构建到处运行，而 Dockerfile 就是用来干这个事儿的</p>
<p>docker 客户端启动了两个窗口，其中一个启动了容器</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# docker run -p 8080:8080 tomcat</span><br><span class="line">31-Dec-2019 10:28:22.424 INFO [main] org.apache.catalina.startup.VersionLoggerListener.log Server version name:   Apache Tomcat/8.5.50</span><br><span class="line">31-Dec-2019 10:28:22.426 INFO [main] org.apache.catalina.startup.VersionLoggerListener.log Server built:          Dec 7 2019 19:19:46 UTC</span><br><span class="line">31-Dec-2019 10:28:22.426 INFO [main] org.apache.catalina.startup.VersionLoggerListener.log Server version number: 8.5.50.0</span><br><span class="line">31-Dec-2019 10:28:22.426 INFO [main] org.apache.catalina.startup.VersionLoggerListener.log OS Name:               Linux</span><br><span class="line">31-Dec-2019 10:28:22.426 INFO [main] org.apache.catalina.startup.VersionLoggerListener.log OS Version:            3.10.0-1062.4.3.el7.x86_64</span><br><span class="line">31-Dec-2019 10:28:22.426 INFO [main] org.apache.catalina.startup.VersionLoggerListener.log Architecture:          amd64</span><br><span class="line">31-Dec-2019 10:28:22.426 INFO [main] org.apache.catalina.startup.VersionLoggerListener.log Java Home:             /usr/local/openjdk-8/jre</span><br><span class="line">31-Dec-2019 10:28:22.426 INFO [main] org.apache.catalina.startup.VersionLoggerListener.log JVM Version:           1.8.0_232-b09</span><br><span class="line">31-Dec-2019 10:28:22.426 INFO [main] org.apache.catalina.startup.VersionLoggerListener.log JVM Vendor:            Oracle Corporation</span><br><span class="line">31-Dec-2019 10:28:22.426 INFO [main] org.apache.catalina.startup.VersionLoggerListener.log CATALINA_BASE:         /usr/local/tomcat</span><br><span class="line">31-Dec-2019 10:28:22.426 INFO [main] org.apache.catalina.startup.VersionLoggerListener.log CATALINA_HOME:         /usr/local/tomcat</span><br><span class="line">.....</span><br></pre></td></tr></table></figure>
<p>在另一个窗口查看：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# docker ps</span><br><span class="line">CONTAINER ID        IMAGE               COMMAND                  CREATED             STATUS              PORTS                               NAMES</span><br><span class="line">d17e030abc9a        tomcat              "catalina.sh run"        2 minutes ago       Up 2 minutes        0.0.0.0:8080-&gt;8080/tcp              charming_chatterjee</span><br></pre></td></tr></table></figure>
<p>接着以交互的方式进入容器：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# docker exec -it d17e030abc9a bash</span><br><span class="line">root@d17e030abc9a:/usr/local/tomcat# ls</span><br><span class="line">BUILDING.txt  CONTRIBUTING.md  LICENSE	NOTICE	README.md  RELEASE-NOTES  RUNNING.txt  bin  conf  include  lib	logs  native-jni-lib  temp  webapps  work</span><br><span class="line">root@d17e030abc9a:/usr/local/tomcat# cd webapps/ROOT/</span><br><span class="line">root@d17e030abc9a:/usr/local/tomcat/webapps/ROOT# ls -al</span><br><span class="line">total 184</span><br><span class="line">drwxr-xr-x. 3 root root  4096 Dec 13 23:52 .</span><br><span class="line">drwxr-xr-x. 7 root root    81 Dec  7 19:21 ..</span><br><span class="line">-rw-r--r--. 1 root root  7136 Dec  7 19:23 RELEASE-NOTES.txt</span><br><span class="line">drwxr-xr-x. 2 root root    21 Dec 13 23:52 WEB-INF</span><br><span class="line">-rw-r--r--. 1 root root 27235 Dec  7 19:23 asf-logo-wide.svg</span><br><span class="line">-rw-r--r--. 1 root root   713 Dec  7 19:21 bg-button.png</span><br><span class="line">-rw-r--r--. 1 root root  1918 Dec  7 19:21 bg-middle.png</span><br><span class="line">-rw-r--r--. 1 root root  1401 Dec  7 19:21 bg-nav.png</span><br><span class="line">-rw-r--r--. 1 root root  3103 Dec  7 19:21 bg-upper.png</span><br><span class="line">-rw-r--r--. 1 root root 21630 Dec  7 19:21 favicon.ico</span><br><span class="line">-rw-r--r--. 1 root root 12219 Dec  7 19:23 index.jsp</span><br><span class="line">-rw-r--r--. 1 root root  2376 Dec  7 19:21 tomcat-power.gif</span><br><span class="line">-rw-r--r--. 1 root root  5581 Dec  7 19:23 tomcat.css</span><br><span class="line">-rw-r--r--. 1 root root  2066 Dec  7 19:21 tomcat.gif</span><br><span class="line">-rw-r--r--. 1 root root  5103 Dec  7 19:21 tomcat.png</span><br><span class="line">-rw-r--r--. 1 root root 67795 Dec  7 19:23 tomcat.svg</span><br><span class="line">root@d17e030abc9a:/usr/local/tomcat/webapps/ROOT# echo "Hello Docker Tomcat" &gt;&gt; index.jsp</span><br><span class="line">root@d17e030abc9a:/usr/local/tomcat/webapps/ROOT#</span><br></pre></td></tr></table></figure>
<p>浏览器访问 <a href="http://192.168.239.128:8080/" target="_blank" rel="noopener">http://192.168.239.128:8080/</a>，发现 Hello Docker Tomcat 显示在页面上了</p>
<h4 id="Dockerfile-定制镜像"><a href="#Dockerfile-定制镜像" class="headerlink" title="Dockerfile 定制镜像"></a>Dockerfile 定制镜像</h4><p>现在就有个需求,需要定制 tomcat 的镜像, 启动后页面就显示 HelloWorld!</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost /]# cd /usr/local/</span><br><span class="line">[root@localhost local]# mkdir mytomcat</span><br><span class="line">[root@localhost local]# cd mytomcat/</span><br><span class="line">[root@localhost mytomcat]# vi Dockerfile</span><br></pre></td></tr></table></figure>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost mytomcat]# cat Dockerfile </span><br><span class="line">from tomcat</span><br><span class="line">workdir /usr/local/tomcat/webapps/ROOT/  #使用 workdir 而不是 cd </span><br><span class="line">run rm -rf *   # 删除ROOT目录下所有文件</span><br><span class="line">run echo "Hello, Docker, Hi, HeGuang" &gt; /usr/local/tomcat/webapps/ROOT/index.html</span><br></pre></td></tr></table></figure>
<p>构建镜像</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost mytomcat]# docker build -t mytomcat .</span><br><span class="line">Sending build context to Docker daemon  2.048kB</span><br><span class="line">Step 1/4 : from tomcat</span><br><span class="line"> ---&gt; 6fa48e047721</span><br><span class="line">Step 2/4 : workdir /usr/local/tomcat/webapps/ROOT/</span><br><span class="line"> ---&gt; Running in e9267120efc5</span><br><span class="line">Removing intermediate container e9267120efc5</span><br><span class="line"> ---&gt; cd9b6d90f7ba</span><br><span class="line">Step 3/4 : run rm -rf *</span><br><span class="line"> ---&gt; Running in bf40a7fa22b8</span><br><span class="line">Removing intermediate container bf40a7fa22b8</span><br><span class="line"> ---&gt; 125efb0662f1</span><br><span class="line">Step 4/4 : run echo &quot;Hello, Docker, Hi, HeGuang&quot; &gt; /usr/local/tomcat/webapps/ROOT/index.html</span><br><span class="line"> ---&gt; Running in 221b4a3834f6</span><br><span class="line">Removing intermediate container 221b4a3834f6</span><br><span class="line"> ---&gt; 526d8e59aecf</span><br><span class="line">Successfully built 526d8e59aecf</span><br><span class="line">Successfully tagged mytomcat:latest</span><br></pre></td></tr></table></figure>
<p>查看构建的镜像<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost mytomcat]# docker images</span><br><span class="line">REPOSITORY          TAG                 IMAGE ID            CREATED             SIZE</span><br><span class="line">mytomcat            latest              526d8e59aecf        12 seconds ago      507MB</span><br><span class="line">tomcat              latest              6fa48e047721        2 weeks ago         507MB</span><br><span class="line">mysql               5.7                 1e4405fe1ea9        5 weeks ago         437MB</span><br><span class="line">[root@localhost mytomcat]# docker run -it mytomcat bash</span><br><span class="line">root@ff63ff945c8f:/usr/local/tomcat/webapps/ROOT# ls -al</span><br><span class="line">total 4</span><br><span class="line">drwxr-xr-x. 1 root root 24 Dec 31 12:16 .</span><br><span class="line">drwxr-xr-x. 1 root root 18 Dec  7 19:21 ..</span><br><span class="line">-rw-r--r--. 1 root root 27 Dec 31 12:16 index.html</span><br><span class="line">root@ff63ff945c8f:/usr/local/tomcat/webapps/ROOT#</span><br></pre></td></tr></table></figure></p>
<p>测试一波</p>
<p><img src="/2019/12/25/docker/1577799017713.png" alt="1577799017713"></p>
<h4 id="镜像构建上下文（Context）"><a href="#镜像构建上下文（Context）" class="headerlink" title="镜像构建上下文（Context）"></a>镜像构建上下文（Context）</h4><p>如果注意，会看到 <code>docker build</code> 命令最后有一个 <code>.</code>。<code>.</code> 表示当前目录，而 <code>Dockerfile</code> 就在当前目录，因此不少初学者以为这个路径是在指定 <code>Dockerfile</code> 所在路径，这么理解其实是不准确的。如果对应上面的命令格式，你可能会发现，这是在指定<strong>上下文路径</strong>。那么什么是上下文呢？</p>
<p>首先我们要理解 <code>docker build</code> 的工作原理。Docker 在运行时分为 Docker 引擎（也就是服务端守护进程）和客户端工具。Docker 的引擎提供了一组 REST API，被称为 <a href="https://docs.docker.com/engine/reference/api/docker_remote_api/" target="_blank" rel="noopener">Docker Remote API</a>，而如 <code>docker</code> 命令这样的客户端工具，则是通过这组 API 与 Docker 引擎交互，从而完成各种功能。因此，虽然表面上我们好像是在本机执行各种 <code>docker</code> 功能，但实际上，一切都是使用的远程调用形式在服务端（Docker 引擎）完成。也因为这种 C/S 设计，让我们操作远程服务器的 Docker 引擎变得轻而易举。</p>
<p>当我们进行镜像构建的时候，并非所有定制都会通过 <code>RUN</code> 指令完成，经常会需要将一些本地文件复制进镜像，比如通过 <code>COPY</code> 指令、<code>ADD</code> 指令等。而 <code>docker build</code> 命令构建镜像，其实并非在本地构建，而是在服务端，也就是 Docker 引擎中构建的。那么在这种客户端/服务端的架构中，如何才能让服务端获得本地文件呢？</p>
<p>这就引入了上下文的概念。当构建的时候，用户会指定构建镜像上下文的路径，<code>docker build</code> 命令得知这个路径后，会将路径下的所有内容打包，然后上传给 Docker 引擎。这样 Docker 引擎收到这个上下文包后，展开就会获得构建镜像所需的一切文件。</p>
<p>如果在 <code>Dockerfile</code> 中这么写：</p>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">COPY</span> ./package.json /app/</span><br></pre></td></tr></table></figure>
<p>这并不是要复制执行 <code>docker build</code> 命令所在的目录下的 <code>package.json</code>，也不是复制 <code>Dockerfile</code> 所在目录下的 <code>package.json</code>，而是复制 <strong>上下文（context）</strong> 目录下的 <code>package.json</code>。</p>
<p>因此，<code>COPY</code> 这类指令中的源文件的路径都是<em>相对路径</em>。这也是初学者经常会问的为什么 <code>COPY ../package.json /app</code> 或者 <code>COPY /opt/xxxx /app</code> 无法工作的原因，因为这些路径已经超出了上下文的范围，Docker 引擎无法获得这些位置的文件。如果真的需要那些文件，应该将它们复制到上下文目录中去。</p>
<p>现在就可以理解刚才的命令 <code>docker build -t nginx:v3 .</code> 中的这个 <code>.</code>，实际上是在指定上下文的目录，<code>docker build</code> 命令会将该目录下的内容打包交给 Docker 引擎以帮助构建镜像。</p>
<p>如果观察 <code>docker build</code> 输出，我们其实已经看到了这个发送上下文的过程：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ docker build -t nginx:v3 .</span><br><span class="line">Sending build context to Docker daemon 2.048 kB</span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>理解构建上下文对于镜像构建是很重要的，避免犯一些不应该的错误。比如有些初学者在发现 <code>COPY /opt/xxxx /app</code> 不工作后，于是干脆将 <code>Dockerfile</code> 放到了硬盘根目录去构建，结果发现 <code>docker build</code> 执行后，在发送一个几十 GB 的东西，极为缓慢而且很容易构建失败。那是因为这种做法是在让 <code>docker build</code> 打包整个硬盘，这显然是使用错误。</p>
<p>一般来说，应该会将 <code>Dockerfile</code> 置于一个空目录下，或者项目根目录下。如果该目录下没有所需文件，那么应该把所需文件复制一份过来。如果目录下有些东西确实不希望构建时传给 Docker 引擎，那么可以用 <code>.gitignore</code> 一样的语法写一个 <code>.dockerignore</code>，该文件是用于剔除不需要作为上下文传递给 Docker 引擎的。</p>
<p>那么为什么会有人误以为 <code>.</code> 是指定 <code>Dockerfile</code> 所在目录呢？这是因为在默认情况下，如果不额外指定 <code>Dockerfile</code> 的话，会将上下文目录下的名为 <code>Dockerfile</code> 的文件作为 Dockerfile。</p>
<p>这只是默认行为，实际上 <code>Dockerfile</code> 的文件名并不要求必须为 <code>Dockerfile</code>，而且并不要求必须位于上下文目录中，比如可以用 <code>-f ../Dockerfile.php</code> 参数指定某个文件作为 <code>Dockerfile</code>。</p>
<p>当然，一般大家习惯性的会使用默认的文件名 <code>Dockerfile</code>，以及会将其置于镜像构建上下文目录中。</p>
<p>比如现在要复制 index.html 到定制镜像中</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost mytomcat]# ls</span><br><span class="line">Dockerfile  index.html</span><br><span class="line">[root@localhost mytomcat]# vi Dockerfile </span><br><span class="line">[root@localhost mytomcat]# cat Dockerfile </span><br><span class="line">from tomcat</span><br><span class="line"><span class="meta">#</span><span class="bash">     上下分路径中的文件  镜像的目录</span></span><br><span class="line">copy index.html   /usr/local/tomcat/webapps/ROOT/</span><br></pre></td></tr></table></figure>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost mytomcat]# docker build -t tomcat002 .</span><br><span class="line">Sending build context to Docker daemon  3.072kB</span><br><span class="line">Step 1/2 : from tomcat</span><br><span class="line"><span class="meta"> ---&gt;</span><span class="bash"> 6fa48e047721</span></span><br><span class="line">Step 2/2 : copy index.html /usr/local/tomcat/webapps/ROOT/</span><br><span class="line"><span class="meta"> ---&gt;</span><span class="bash"> 2fbc9185e236</span></span><br><span class="line">Successfully built 2fbc9185e236</span><br><span class="line">Successfully tagged tomcat002:latest</span><br><span class="line">[root@localhost mytomcat]# docker images</span><br><span class="line">REPOSITORY          TAG                 IMAGE ID            CREATED             SIZE</span><br><span class="line">tomcat002           latest              2fbc9185e236        22 seconds ago      507MB</span><br><span class="line">tomcat              latest              6fa48e047721        2 weeks ago         507MB</span><br><span class="line">[root@localhost mytomcat]# docker run -it --rm tomcat002 bash</span><br><span class="line">root@f25573a12089:/usr/local/tomcat# ls -al</span><br><span class="line">total 124</span><br><span class="line">drwxr-sr-x. 1 root staff    21 Dec 13 23:52 .</span><br><span class="line">drwxrwsr-x. 1 root staff    20 Nov 23 16:34 ..</span><br><span class="line">-rw-r--r--. 1 root root  19318 Dec  7 19:23 BUILDING.txt</span><br><span class="line">drwxr-xr-x. 2 root root   4096 Dec 13 23:52 bin</span><br><span class="line">drwxr-sr-x. 2 root root    238 Dec  7 19:23 conf</span><br><span class="line">drwxr-sr-x. 2 root staff    78 Dec 13 23:52 include</span><br><span class="line">drwxrwxrwx. 2 root root     30 Dec 13 23:52 temp</span><br><span class="line">drwxr-xr-x. 1 root root     18 Dec  7 19:21 webapps</span><br><span class="line">drwxrwxrwx. 2 root root      6 Dec  7 19:19 work</span><br><span class="line">root@f25573a12089:/usr/local/tomcat# cd webapps/ROOT/</span><br><span class="line">root@f25573a12089:/usr/local/tomcat/webapps/ROOT# ls -al</span><br><span class="line">total 184</span><br><span class="line">drwxr-xr-x. 1 root root    24 Dec 31 13:45 .</span><br><span class="line">drwxr-xr-x. 1 root root    18 Dec  7 19:21 ..</span><br><span class="line">-rw-r--r--. 1 root root 21630 Dec  7 19:21 favicon.ico</span><br><span class="line">-rw-r--r--. 1 root root   231 Dec 31 13:41 index.html</span><br><span class="line">-rw-r--r--. 1 root root 12219 Dec  7 19:23 index.jsp</span><br><span class="line">-rw-r--r--. 1 root root  5103 Dec  7 19:21 tomcat.png</span><br><span class="line">-rw-r--r--. 1 root root 67795 Dec  7 19:23 tomcat.svg</span><br><span class="line">root@f25573a12089:/usr/local/tomcat/webapps/ROOT#</span><br></pre></td></tr></table></figure>

          <br>
<p>hogen</p>
<div class="date">2019-12-25</div>

        </section>
      </div>
      
      <div class="block">
  
    <a class="main" href="/">Home</a>
  
    <a class="main" href="/about">About</a>
  
    <a class="main" href="https://github.com/hogenlaw">Github</a>
  
    <a class="main" href="mailto:lhg9300@foxmail.com">Email</a>
  
</div>

    </div>
    <footer>
  <span class="muted">Powered by hogenlaw</span>
</footer>

  </body>
</html>
